Garage is an internet of things garage door lock and opener for the 
raspberry pi. It uses nodejs and jwt to receive signed tokens to command a garage door to unlock and then trigger the opener. I've now got this partially installed in my garage - only missing the physical sensor.

When a token is verified and the open-close command is received, GPIO 17 (pin 11) will go active low to trigger the lock solenoid. Then GPIO 27 (pin 13) will go active low for half a second triggering the opener. 15 seconds later GPIO pin 17 will go inactive releasing the lock solenoid. You could use any GPIO pins, but these are right next to each other and a ground pin.

GPIO 22 (pin 15) will also trigger the lock and opener. This pin has an internal pull down. It it intended that this and 3v3 Power (pin 1) get connected to one's existing opener button to manually open/close. 

The lock is expected to work with a 120VAC solenoid and metal rod that will block the path of a garage door's rollers. 

A sensor to detect when the garage door is opened for an unknown reason will also be added. Using Twilio, an SMS message will be sent.

An iOS app has also been started which will generate keys, and send signed open-close requests.

Needed info to setup:
API Key - random string of characters saved to ./keys/config.json
Each request will have this query parameter and will be checked first. This is mainly to keep lurkers away.

https keys - You can get these from https://letsencrypt.org. Install key.pem and cert.pem in ./keys/

IP Address and port - to access the raspberry pi. If one's ip address isn't static a Dynamic Domain Name System service could be used instead. You'll also need to forward the port in your router and/or modem.

User ID - any integer to identify amongst multiple users.

Private, public rsa key generated by openssl (one per user). The private key is used to sign jwt tokens. The public key is used to verify the signature and should be installed in ./keys/ with a filename format of [USER_ID]-public.pem

A number of node packages are defined in package.json. Install them with `npm install`.

Relays and a solenoid. I found a board with two 5v relays locally similar to this: https://www.sainsmart.com/products/2-channel-5v-relay-module
When complete I'll include drawings and/or wiring diagrams.

This application can be run from the command line with `node app.js`

To generate a test token use `node genJwt.js [USERID] [COMMAND]`. From a web browser the url takes the format: "https://[IP]:[PORT]/api/garage?apikey=[API_KEY]&token=[JWT]"
A response including the word 'verify' is successful. The payload of the jwt has the following format: `{"uid": 1, "command": "verify", "iat": TIMESTAMP}` 

Security info:
We're using jwt tokens with the RS256 algorithm for extra security. A private key signs tokens for which verification can only be done with the matching public key. Tokens older than two minutes are rejected. Even if one were to get a copy of a token it would soon be invalid. Communicating over https provides further protection.

./keys/config.json uses the following format:
{
  "rpi": false,
  "apiKey":  "API KEY string",
  "authToken": "TWILIO AUTH TOKEN",
  "accountSid": "TWILIO ACCOUNT SID",
  "from": "FROM TWILIO NUMBER",
  "to": "PHONE NUMBER TO SEND SMS"
}